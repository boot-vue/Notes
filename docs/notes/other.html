<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å…¶å®ƒ | å•ªå•ªå•ªçš„æŒ‡é’ˆ</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/Notes/assets/css/0.styles.da86275c.css" as="style"><link rel="preload" href="/Notes/assets/js/app.f969e584.js" as="script"><link rel="preload" href="/Notes/assets/js/2.224388cf.js" as="script"><link rel="preload" href="/Notes/assets/js/7.4c3aeaf8.js" as="script"><link rel="prefetch" href="/Notes/assets/js/10.d06695ce.js"><link rel="prefetch" href="/Notes/assets/js/11.b6e94113.js"><link rel="prefetch" href="/Notes/assets/js/12.ab2ab82a.js"><link rel="prefetch" href="/Notes/assets/js/13.177a0288.js"><link rel="prefetch" href="/Notes/assets/js/14.8a67229a.js"><link rel="prefetch" href="/Notes/assets/js/15.abdfeba1.js"><link rel="prefetch" href="/Notes/assets/js/16.918e2f7a.js"><link rel="prefetch" href="/Notes/assets/js/17.9934056a.js"><link rel="prefetch" href="/Notes/assets/js/18.8c574ad9.js"><link rel="prefetch" href="/Notes/assets/js/19.dd0e0bda.js"><link rel="prefetch" href="/Notes/assets/js/20.0ba054ac.js"><link rel="prefetch" href="/Notes/assets/js/21.d026288a.js"><link rel="prefetch" href="/Notes/assets/js/22.bf5c76b4.js"><link rel="prefetch" href="/Notes/assets/js/23.c23f4049.js"><link rel="prefetch" href="/Notes/assets/js/24.9747a783.js"><link rel="prefetch" href="/Notes/assets/js/25.8a13bd57.js"><link rel="prefetch" href="/Notes/assets/js/26.dba03977.js"><link rel="prefetch" href="/Notes/assets/js/27.db78c622.js"><link rel="prefetch" href="/Notes/assets/js/28.8956aa2c.js"><link rel="prefetch" href="/Notes/assets/js/29.cbbea56f.js"><link rel="prefetch" href="/Notes/assets/js/3.0eefd532.js"><link rel="prefetch" href="/Notes/assets/js/30.8b7fd7ed.js"><link rel="prefetch" href="/Notes/assets/js/31.9eba3128.js"><link rel="prefetch" href="/Notes/assets/js/32.1fb27cf9.js"><link rel="prefetch" href="/Notes/assets/js/33.6eaf0d43.js"><link rel="prefetch" href="/Notes/assets/js/34.c230e8c7.js"><link rel="prefetch" href="/Notes/assets/js/35.5a5935e8.js"><link rel="prefetch" href="/Notes/assets/js/36.eac5db80.js"><link rel="prefetch" href="/Notes/assets/js/37.43596a8c.js"><link rel="prefetch" href="/Notes/assets/js/4.01d61243.js"><link rel="prefetch" href="/Notes/assets/js/5.2652c930.js"><link rel="prefetch" href="/Notes/assets/js/6.b98170cf.js"><link rel="prefetch" href="/Notes/assets/js/8.18217946.js"><link rel="prefetch" href="/Notes/assets/js/9.cfdb3130.js">
    <link rel="stylesheet" href="/Notes/assets/css/0.styles.da86275c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Notes/" class="home-link router-link-active"><!----> <span class="site-name">å•ªå•ªå•ªçš„æŒ‡é’ˆ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Notes/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/Notes/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/Notes/hadoop/" class="nav-link">
  Hadoop
</a></div><div class="nav-item"><a href="/Notes/go/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/Notes/python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/Notes/open/" class="nav-link">
  å¥½å·¥å…·
</a></div><div class="nav-item"><a href="/Notes/sharp/" class="nav-link">
  åˆ©å™¨
</a></div><div class="nav-item"><a href="/Notes/web/" class="nav-link">
  å‰ç«¯ | APP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ‚ä¸ƒæ‚å…«" class="dropdown-title"><span class="title">æ‚ä¸ƒæ‚å…«</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¦å¤šæ‚æœ‰å¤šæ‚
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notes/notes/setting.html" class="nav-link">
  å¸¸ç”¨é…ç½®
</a></li><li class="dropdown-subitem"><a href="/Notes/notes/shell.html" class="nav-link">
  Shell
</a></li><li class="dropdown-subitem"><a href="/Notes/notes/linux.html" class="nav-link">
  Linux
</a></li><li class="dropdown-subitem"><a href="/Notes/notes/other.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å…¶å®ƒ
</a></li></ul></li><li class="dropdown-item"><h4>
          æˆ‘çš„ç ´çƒ‚~
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notes/notes/xianyu.html" class="nav-link">
  å¥½ä¸œè¥¿å•Š
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/boot-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Notes/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/Notes/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/Notes/hadoop/" class="nav-link">
  Hadoop
</a></div><div class="nav-item"><a href="/Notes/go/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/Notes/python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/Notes/open/" class="nav-link">
  å¥½å·¥å…·
</a></div><div class="nav-item"><a href="/Notes/sharp/" class="nav-link">
  åˆ©å™¨
</a></div><div class="nav-item"><a href="/Notes/web/" class="nav-link">
  å‰ç«¯ | APP
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ‚ä¸ƒæ‚å…«" class="dropdown-title"><span class="title">æ‚ä¸ƒæ‚å…«</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¦å¤šæ‚æœ‰å¤šæ‚
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notes/notes/setting.html" class="nav-link">
  å¸¸ç”¨é…ç½®
</a></li><li class="dropdown-subitem"><a href="/Notes/notes/shell.html" class="nav-link">
  Shell
</a></li><li class="dropdown-subitem"><a href="/Notes/notes/linux.html" class="nav-link">
  Linux
</a></li><li class="dropdown-subitem"><a href="/Notes/notes/other.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å…¶å®ƒ
</a></li></ul></li><li class="dropdown-item"><h4>
          æˆ‘çš„ç ´çƒ‚~
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notes/notes/xianyu.html" class="nav-link">
  å¥½ä¸œè¥¿å•Š
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/boot-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Notes/notes/setting.html" class="sidebar-link">å¸¸ç”¨é…ç½®</a></li><li><a href="/Notes/notes/shell.html" class="sidebar-link">Shell</a></li><li><a href="/Notes/notes/linux.html" class="sidebar-link">Linux</a></li><li><a href="/Notes/notes/pass.html" class="sidebar-link">å¯†ç å­¦ ğŸ’¥</a></li><li><a href="/Notes/notes/other.html" aria-current="page" class="active sidebar-link">å…¶å®ƒ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#systemctl-æœåŠ¡" class="sidebar-link">systemctl æœåŠ¡</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#å¹¶å‘ç¼–ç¨‹" class="sidebar-link">å¹¶å‘ç¼–ç¨‹</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#å‡½æ•°å¼ç¼–ç¨‹" class="sidebar-link">å‡½æ•°å¼ç¼–ç¨‹</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#mysql-åˆ†åŒº" class="sidebar-link">MySQL åˆ†åŒº</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#redis" class="sidebar-link">Redis</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#rabbit" class="sidebar-link">Rabbit</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#spring-äº‹åŠ¡" class="sidebar-link">Spring äº‹åŠ¡</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#springmvc-å¼‚æ­¥å¤„ç†" class="sidebar-link">SpringMvc å¼‚æ­¥å¤„ç†</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#dockerfile" class="sidebar-link">Dockerfile</a></li><li class="sidebar-sub-header"><a href="/Notes/notes/other.html#gradle" class="sidebar-link">Gradle</a></li></ul></li><li><a href="/Notes/notes/xianyu.html" class="sidebar-link">ç ´çƒ‚~ ğŸ‘»</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="header-anchor">#</a> å…¶å®ƒ</h1> <p>ä¹±ä¸ƒå…«ç³Ÿ ğŸ’£ğŸ’£ğŸ’£</p> <h2 id="systemctl-æœåŠ¡"><a href="#systemctl-æœåŠ¡" class="header-anchor">#</a> systemctl æœåŠ¡</h2> <blockquote><p>/usr/lib/systemd/ä¸‹, å¼€æœºä¸ç™»å½•å°±èƒ½å¯åŠ¨çš„æœåŠ¡æœ€å¥½æ”¾åœ¨ /usr/lib/systemd/system ç³»ç»ŸæœåŠ¡, .../user: ç”¨æˆ·æœåŠ¡ éœ€è¦ç”¨æˆ·ç™»å½•æ‰å¯ä»¥å¯åŠ¨</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># [Unit]ã€[Service]å’Œ[Install]</span>
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>   <span class="token comment"># ä¸»è¦æ˜¯æœåŠ¡è¯´æ˜</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>test   <span class="token comment"># ç®€å•æè¿°æœåŠ¡</span>
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target    <span class="token comment"># æè¿°æœåŠ¡ç±»åˆ«ï¼Œè¡¨ç¤ºæœ¬æœåŠ¡éœ€è¦åœ¨networkæœåŠ¡å¯åŠ¨ååœ¨å¯åŠ¨</span>
<span class="token assign-left variable">Before</span><span class="token operator">=</span>xxx.service      <span class="token comment"># è¡¨ç¤ºéœ€è¦åœ¨æŸäº›æœåŠ¡å¯åŠ¨ä¹‹å‰å¯åŠ¨ï¼ŒAfterå’ŒBeforeå­—æ®µåªæ¶‰åŠå¯åŠ¨é¡ºåºï¼Œä¸æ¶‰åŠä¾èµ–å…³ç³»</span>

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>  <span class="token comment"># æ ¸å¿ƒåŒºåŸŸ</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking     <span class="token comment"># è¡¨ç¤ºåå°è¿è¡Œæ¨¡å¼ã€‚</span>
<span class="token assign-left variable">User</span><span class="token operator">=</span>root        <span class="token comment"># è®¾ç½®æœåŠ¡è¿è¡Œçš„ç”¨æˆ·</span>
<span class="token assign-left variable">Group</span><span class="token operator">=</span>root       <span class="token comment"># è®¾ç½®æœåŠ¡è¿è¡Œçš„ç”¨æˆ·ç»„</span>
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>control-group   <span class="token comment"># å®šä¹‰systemdå¦‚ä½•åœæ­¢æœåŠ¡</span>
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/usr/local/test/test.pid    <span class="token comment"># å­˜æ”¾PIDçš„ç»å¯¹è·¯å¾„</span>
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>no        <span class="token comment"># å®šä¹‰æœåŠ¡è¿›ç¨‹é€€å‡ºåï¼Œsystemdçš„é‡å¯æ–¹å¼ï¼Œé»˜è®¤æ˜¯ä¸é‡å¯</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/test/bin/startup.sh    <span class="token comment"># æœåŠ¡å¯åŠ¨å‘½ä»¤ï¼Œå‘½ä»¤éœ€è¦ç»å¯¹è·¯å¾„</span>
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/xxxxx
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/xxxxx
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true                               <span class="token comment"># è¡¨ç¤ºç»™æœåŠ¡åˆ†é…ç‹¬ç«‹çš„ä¸´æ—¶ç©ºé—´</span>

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target  <span class="token comment"># å¤šç”¨æˆ·</span>

<span class="token comment">#Typeçš„ç±»å‹æœ‰ï¼š</span>
<span class="token comment">#    simple(é»˜è®¤ï¼‰ï¼š# ä»¥ExecStartå­—æ®µå¯åŠ¨çš„è¿›ç¨‹ä¸ºä¸»è¿›ç¨‹</span>
<span class="token comment">#    forking:  # ExecStartå­—æ®µä»¥fork()æ–¹å¼å¯åŠ¨ï¼Œæ­¤æ—¶çˆ¶è¿›ç¨‹å°†é€€å‡ºï¼Œå­è¿›ç¨‹å°†æˆä¸ºä¸»è¿›ç¨‹ï¼ˆåå°è¿è¡Œï¼‰ã€‚ä¸€èˆ¬éƒ½è®¾ç½®ä¸ºforking</span>
<span class="token comment">#    oneshot:  # ç±»ä¼¼äºsimpleï¼Œä½†åªæ‰§è¡Œä¸€æ¬¡ï¼Œsystemdä¼šç­‰å®ƒæ‰§è¡Œå®Œï¼Œæ‰å¯åŠ¨å…¶ä»–æœåŠ¡</span>
<span class="token comment">#    dbusï¼š    # ç±»ä¼¼äºsimple, ä½†ä¼šç­‰å¾…D-Busä¿¡å·åå¯åŠ¨</span>
<span class="token comment">#    notify:   # ç±»ä¼¼äºsimple, å¯åŠ¨ç»“æŸåä¼šå‘å‡ºé€šçŸ¥ä¿¡å·ï¼Œç„¶åsystemdå†å¯åŠ¨å…¶ä»–æœåŠ¡</span>
<span class="token comment">#    idleï¼š    # ç±»ä¼¼äºsimpleï¼Œä½†æ˜¯è¦ç­‰åˆ°å…¶ä»–ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œæ‰ä¼šå¯åŠ¨è¯¥æœåŠ¡ã€‚</span>
<span class="token comment">#</span>
<span class="token comment">#EnvironmentFile:</span>
<span class="token comment">#    æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œå’Œè¿è¯å·ç»„åˆä½¿ç”¨ï¼Œå¯ä»¥é¿å…é…ç½®æ–‡ä»¶ä¸å­˜åœ¨çš„å¼‚å¸¸ã€‚</span>
<span class="token comment">#</span>
<span class="token comment">#Environment:</span>
<span class="token comment">#    åé¢æ¥å¤šä¸ªä¸åŒçš„shellå˜é‡ã€‚</span>
<span class="token comment">#    ä¾‹å¦‚ï¼š</span>
<span class="token comment">#    Environment=DATA_DIR=/data/elk</span>
<span class="token comment">#    Environment=LOG_DIR=/var/log/elasticsearch</span>
<span class="token comment">#    Environment=PID_DIR=/var/run/elasticsearch</span>
<span class="token comment">#    EnvironmentFile=-/etc/sysconfig/elasticsearch</span>
<span class="token comment">#</span>
<span class="token comment">#è¿è¯å·ï¼ˆ-ï¼‰ï¼šåœ¨æ‰€æœ‰å¯åŠ¨è®¾ç½®ä¹‹å‰ï¼Œæ·»åŠ çš„å˜é‡å­—æ®µï¼Œéƒ½å¯ä»¥åŠ ä¸Šè¿è¯å·</span>
<span class="token comment">#    è¡¨ç¤ºæŠ‘åˆ¶é”™è¯¯ï¼Œå³å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¸å½±å“å…¶ä»–å‘½ä»¤çš„æ‰§è¡Œã€‚</span>
<span class="token comment">#    æ¯”å¦‚`EnviromentFile=-/etc/sysconfig/xxx` è¡¨ç¤ºå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ›å¼‚å¸¸</span>
<span class="token comment">#</span>
<span class="token comment">#KillModeçš„ç±»å‹ï¼š</span>
<span class="token comment">#    control-group(é»˜è®¤)ï¼š# å½“å‰æ§åˆ¶ç»„é‡Œçš„æ‰€æœ‰å­è¿›ç¨‹ï¼Œéƒ½ä¼šè¢«æ€æ‰</span>
<span class="token comment">#    process: # åªæ€ä¸»è¿›ç¨‹</span>
<span class="token comment">#    mixed:   # ä¸»è¿›ç¨‹å°†æ”¶åˆ°SIGTERMä¿¡å·ï¼Œå­è¿›ç¨‹æ”¶åˆ°SIGKILLä¿¡å·</span>
<span class="token comment">#    none:    # æ²¡æœ‰è¿›ç¨‹ä¼šè¢«æ€æ‰ï¼Œåªæ˜¯æ‰§è¡ŒæœåŠ¡çš„stopå‘½ä»¤</span>
<span class="token comment">#Restartçš„ç±»å‹ï¼š</span>
<span class="token comment">#    no(é»˜è®¤å€¼)ï¼š # é€€å‡ºåæ— æ“ä½œ</span>
<span class="token comment">#    on-success:  # åªæœ‰æ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€ç ä¸º0ï¼‰,æ‰ä¼šé‡å¯</span>
<span class="token comment">#    on-failure:  # éæ­£å¸¸é€€å‡ºæ—¶ï¼Œé‡å¯ï¼ŒåŒ…æ‹¬è¢«ä¿¡å·ç»ˆæ­¢å’Œè¶…æ—¶ç­‰</span>
<span class="token comment">#    on-abnormal: # åªæœ‰è¢«ä¿¡å·ç»ˆæ­¢æˆ–è¶…æ—¶ï¼Œæ‰ä¼šé‡å¯</span>
<span class="token comment">#    on-abort:    # åªæœ‰åœ¨æ”¶åˆ°æ²¡æœ‰æ•æ‰åˆ°çš„ä¿¡å·ç»ˆæ­¢æ—¶ï¼Œæ‰ä¼šé‡å¯</span>
<span class="token comment">#    on-watchdog: # è¶…æ—¶é€€å‡ºæ—¶ï¼Œæ‰ä¼šé‡å¯</span>
<span class="token comment">#    always:      # ä¸ç®¡ä»€ä¹ˆé€€å‡ºåŸå› ï¼Œéƒ½ä¼šé‡å¯</span>
<span class="token comment">#    # å¯¹äºå®ˆæŠ¤è¿›ç¨‹ï¼Œæ¨èç”¨on-failure</span>
<span class="token comment">#RestartSecå­—æ®µï¼š</span>
<span class="token comment">#    è¡¨ç¤ºsystemdé‡å¯æœåŠ¡ä¹‹å‰ï¼Œéœ€è¦ç­‰å¾…çš„ç§’æ•°ï¼šRestartSec: 30</span>
<span class="token comment">#</span>
<span class="token comment">#å„ç§Exec*å­—æ®µï¼š</span>
<span class="token comment">#    # Exec* åé¢æ¥çš„å‘½ä»¤ï¼Œä»…æ¥å—â€œæŒ‡ä»¤ å‚æ•° å‚æ•°..â€æ ¼å¼ï¼Œä¸èƒ½æ¥å—&lt;&gt;|&amp;ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¾ˆå¤šbashè¯­æ³•ä¹Ÿä¸æ”¯æŒã€‚å¦‚æœæƒ³æ”¯æŒbashè¯­æ³•ï¼Œéœ€è¦è®¾ç½®Tyep=oneshot</span>
<span class="token comment">#    ExecStartï¼š    # å¯åŠ¨æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token comment">#    ExecReloadï¼š   # é‡å¯æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token comment">#    ExecStopï¼š     # åœæ­¢æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token comment">#    ExecStartPreï¼š # å¯åŠ¨æœåŠ¡å‰æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token comment">#    ExecStartPostï¼š# å¯åŠ¨æœåŠ¡åæ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token comment">#    ExecStopPostï¼š # åœæ­¢æœåŠ¡åæ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token comment">#</span>
<span class="token comment">#</span>
<span class="token comment">#WantedByå­—æ®µï¼š</span>
<span class="token comment">#    multi-user.target: # è¡¨ç¤ºå¤šç”¨æˆ·å‘½ä»¤è¡ŒçŠ¶æ€ï¼Œè¿™ä¸ªè®¾ç½®å¾ˆé‡è¦</span>
<span class="token comment">#    graphical.target:  # è¡¨ç¤ºå›¾å½¢ç”¨æˆ·çŠ¶ä½“ï¼Œå®ƒä¾èµ–äºmulti-user.target</span>
</code></pre></div><h2 id="å¹¶å‘ç¼–ç¨‹"><a href="#å¹¶å‘ç¼–ç¨‹" class="header-anchor">#</a> å¹¶å‘ç¼–ç¨‹</h2> <p><code>Executors</code> çº¿ç¨‹æ±  <code>newFixedThreadPool</code> <code>newCachedThreadPool</code> <code>newSingleThreadExecutor</code> <code>newScheduledThreadPool</code>, æœ€å¥½é€šè¿‡<code>ThreadPoolExecutor</code>åˆ›å»ºçº¿ç¨‹æ± </p> <p>æ–¹æ³•: <code>execute(Runable)</code> <code>shutdown()</code> <code>Future&lt;T&gt; submit(Callable)</code></p> <p><code>Future</code> æ–¹æ³•<code>isDone()</code>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæˆ, <code>get()</code>è·å–ç»“æœ <code>cancel()</code>å–æ¶ˆä»»åŠ¡</p> <h2 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="header-anchor">#</a> å‡½æ•°å¼ç¼–ç¨‹</h2> <p><code>Function</code>: ä¸¤ä¸ªæ–¹æ³• apply andThen
<code>Consumer</code>: accept æ–¹æ³•
<code>Predicate</code> test æ–¹æ³•
<code>Supplier</code>: get æ–¹æ³•</p> <h2 id="mysql-åˆ†åŒº"><a href="#mysql-åˆ†åŒº" class="header-anchor">#</a> MySQL åˆ†åŒº</h2> <ol><li>range: ç»™å®šä¸€ä¸ªè¿ç»­åŒºé—´çš„èŒƒå›´å€¼è¿›è¡Œåˆ†åŒº</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- è¯­æ³•</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span><span class="token keyword">table</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>
    <span class="token comment">// å­—æ®µ</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span>MyISAM  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">partition</span> <span class="token keyword">by</span> range <span class="token punctuation">(</span>åˆ†åŒºå­—æ®µ<span class="token punctuation">)</span> <span class="token punctuation">(</span>
  <span class="token keyword">partition</span> <span class="token operator">&lt;</span>åˆ†åŒºåç§°<span class="token operator">&gt;</span> <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token keyword">Value</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">partition</span> <span class="token operator">&lt;</span>åˆ†åŒºåç§°<span class="token operator">&gt;</span> <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token keyword">Value</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">partition</span> <span class="token operator">&lt;</span>åˆ†åŒºåç§°<span class="token operator">&gt;</span> <span class="token keyword">values</span> less than maxvalue
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>list: è®¾ç½®è‹¥å¹²ä¸ªå›ºå®šå€¼è¿›è¡Œåˆ†åŒºï¼Œå¦‚æœæŸä¸ªå­—æ®µçš„å€¼åœ¨è¿™ä¸ªè®¾ç½®çš„å€¼åˆ—è¡¨ä¸­å°±ä¼šè¢«åˆ†é…åˆ°è¯¥åˆ†åŒº</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- è¯­æ³•</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span><span class="token keyword">table</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>
    <span class="token comment">// å­—æ®µ</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span>æ•°æ®åº“å¼•æ“  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">partition</span> <span class="token keyword">by</span> LIST <span class="token punctuation">(</span>åˆ†åŒºå­—æ®µæˆ–è€…åŸºäºè¯¥å­—æ®µçš„è¿”å›çš„æ•´æ•°å€¼çš„è¡¨è¾¾å¼<span class="token punctuation">)</span> <span class="token punctuation">(</span>
  <span class="token keyword">partition</span> <span class="token operator">&lt;</span>åˆ†åŒºåç§°<span class="token operator">&gt;</span> <span class="token keyword">values</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>Value1ï¼ŒValue2<span class="token punctuation">,</span> Value3<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">partition</span> <span class="token operator">&lt;</span>åˆ†åŒºåç§°<span class="token operator">&gt;</span> <span class="token keyword">values</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>Value4<span class="token punctuation">,</span> Value5<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>columns åˆ†åŒº: columns åˆ†åŒºåˆ†ä¸º range columns å’Œ list columns ä¸¤ç§ï¼Œæ”¯æŒæ•´æ•°(tinyint åˆ° bigintï¼Œ ä¸æ”¯æŒ decimal å’Œ float)ã€æ—¥æœŸ(dateã€datetime)ã€å­—ç¬¦ä¸²(charã€varcharã€binaryã€varbinary)ä¸‰å¤§æ•°æ®ç±»å‹</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">partition</span> <span class="token keyword">by</span> range <span class="token keyword">columns</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">(</span>
   <span class="token keyword">partition</span> p01 <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token keyword">partition</span> p02 <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token keyword">partition</span> p03 <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token keyword">partition</span> p04 <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token keyword">partition</span> p05 <span class="token keyword">values</span> less than <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> maxvalue<span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token keyword">partition</span> p06 <span class="token keyword">values</span> less than <span class="token punctuation">(</span>maxvalue<span class="token punctuation">,</span> maxvalue<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>hash åˆ†åŒº: å¯¹åˆ†åŒºé”®åº”ç”¨ä¸€ä¸ªæ•£åˆ—å‡½æ•°ï¼Œä»¥æ­¤ç¡®å®šæ•°æ®åº”å½“æ”¾åœ¨ N ä¸ªåˆ†åŒºä¸­çš„å“ªä¸ªåˆ†åŒº</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- HASH</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span><span class="token keyword">table</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>
    <span class="token comment">// å­—æ®µ</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">innodb</span>  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> <span class="token keyword">HASH</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span>
PARTITIONS <span class="token operator">&lt;</span>num<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>key åˆ†åŒº: key åˆ†åŒºä¸å…è®¸ä½¿ç”¨ç”¨äºè‡ªå®šä¹‰çš„è¡¨è¾¾å¼ï¼Œéœ€è¦ä½¿ç”¨ mysql æœåŠ¡å™¨æä¾›çš„ hash å‡½æ•°ï¼ŒåŒæ—¶ hash åˆ†åŒºåªæ”¯æŒæ•´æ•°åˆ†åŒºï¼Œè€Œ key åˆ†åŒºæ”¯æŒä½¿ç”¨ blob or text ç±»å‹å¤–çš„å…¶ä»–ç±»å‹çš„åˆ—ä½œä¸ºåˆ†åŒºé”®</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">partition</span> <span class="token keyword">by</span> <span class="token keyword">key</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> partitions num<span class="token punctuation">;</span>

<span class="token comment">-- ä¸æŒ‡å®šé»˜è®¤é¦–é€‰ä¸»é”®ä½œä¸ºåˆ†åŒºé”®ï¼Œåœ¨æ²¡æœ‰ä¸»é”®çš„æƒ…å†µä¸‹ä¼šé€‰æ‹©éç©ºå”¯ä¸€é”®ä½œä¸ºåˆ†åŒºé”®</span>
<span class="token keyword">partition</span> <span class="token keyword">by</span> <span class="token keyword">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span> partitions num<span class="token punctuation">;</span>

<span class="token comment">-- linear key</span>
<span class="token keyword">partition</span> <span class="token keyword">by</span> linear <span class="token keyword">key</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span>
</code></pre></div><h2 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h2> <p>ç¼“å­˜ç­–ç•¥:</p> <p>å¼€å¯å†…å­˜é™åˆ¶ <code>maxmemory bytes</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>noeviction: ä¸åˆ é™¤ç­–ç•¥, è¾¾åˆ°æœ€å¤§å†…å­˜é™åˆ¶æ—¶, å¦‚æœéœ€è¦æ›´å¤šå†…å­˜, ç›´æ¥è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
allkeys-lru: æ‰€æœ‰keyé€šç”¨<span class="token punctuation">;</span> ä¼˜å…ˆåˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨<span class="token punctuation">(</span>less recently used ,LRU<span class="token punctuation">)</span> çš„ key
volatile-lru: åªé™äºè®¾ç½®äº† expire çš„éƒ¨åˆ†<span class="token punctuation">;</span> ä¼˜å…ˆåˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨<span class="token punctuation">(</span>less recently used ,LRU<span class="token punctuation">)</span> çš„ key
allkeys-random: æ‰€æœ‰keyé€šç”¨<span class="token punctuation">;</span> éšæœºåˆ é™¤ä¸€éƒ¨åˆ† key
volatile-random: åªé™äºè®¾ç½®äº† expire çš„éƒ¨åˆ†<span class="token punctuation">;</span> éšæœºåˆ é™¤ä¸€éƒ¨åˆ† key
volatile-ttl: åªé™äºè®¾ç½®äº† expire çš„éƒ¨åˆ†<span class="token punctuation">;</span> ä¼˜å…ˆåˆ é™¤å‰©ä½™æ—¶é—´<span class="token punctuation">(</span>time to live,TTL<span class="token punctuation">)</span> çŸ­çš„key
</code></pre></div><p>RDB: æ‰‹åŠ¨/è‡ªåŠ¨è§¦å‘,dump å¿«ç…§æ–¹å¼, save m n: è¡¨ç¤º m ç§’ä¹‹å†…æ•°æ®é›†å­˜åœ¨ n æ¬¡ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨è§¦å‘ bgsave
AOF: ç‹¬ç«‹ log æ—¥å¿—è®°å½•å†™æ“ä½œ always:æ¯æ¬¡å†™æ“ä½œéƒ½è®°å½• everysec: 1 ç§’åŒæ­¥è®°å½•ä¸€æ¬¡ no:ä¸åŒæ­¥è®°å½•</p> <p>redis å¯†ç é…ç½® requirepass xxx
ä¸»ä»é…ç½® slaveof ip port
master æœ‰å¯†ç çš„è¯ masterauth xxx</p> <p>å“¨å…µé…ç½® sentinel.conf
sentinel monitor master_name ip port ç¥¨æ•°(1,2....) ------&gt;ç›‘å¬ master, é›†ç¾¤ä¸‹ä¿è¯ master_name ä¸€è‡´, æœ€å¥½æ¯ä¸ªèŠ‚ç‚¹éƒ½æ”¾ä¸€ä¸ª sentinel.conf
å¯åŠ¨å“¨å…µ redis-sentinel /.....sentinel.conf
æœ‰ redis-server æŒ‚æ‰, å“¨å…µä¼šé‡æ–°é€‰æ‹© master</p> <p><img src="/Notes/assets/img/redis.b6af2214.png" alt="redis"></p> <p>spring boot é…ç½®å“¨å…µ:</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">master</span><span class="token punctuation">:</span> testmaster
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span> 192.168.142.88<span class="token punctuation">:</span><span class="token number">26379</span><span class="token punctuation">,</span>192.168.142.89<span class="token punctuation">:</span><span class="token number">26379</span><span class="token punctuation">,</span>192.168.142.90<span class="token punctuation">:</span><span class="token number">26379</span>
</code></pre></div><h2 id="rabbit"><a href="#rabbit" class="header-anchor">#</a> Rabbit</h2> <h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="header-anchor">#</a> æ³¨æ„:</h3> <ol><li>å¦‚æœä¸æŒ‡å®š exchange, é»˜è®¤èµ° amqp default exchange, ==routing-key==ä¸==queue==ååŒ¹é…ä¸€è‡´æŠ•é€’</li></ol> <h3 id="exchange-äº¤æ¢æœº"><a href="#exchange-äº¤æ¢æœº" class="header-anchor">#</a> exchange äº¤æ¢æœº</h3> <ol><li>direct: ==routing-key==å¿…é¡»å®Œå…¨åŒ¹é…</li> <li>topic: ==routing-key==æ¨¡ç³ŠåŒ¹é…</li></ol> <blockquote><p>#åŒ¹é…å¤šä¸ªè¯ *åŒ¹é…ä¸€ä¸ªè¯</p></blockquote> <ol start="3"><li>fanout: ==ä¸å¤„==ç† routing-key, exchange ä¸ queue ç›´æ¥ç»‘å®š</li></ol> <h3 id="message-æ¶ˆæ¯"><a href="#message-æ¶ˆæ¯" class="header-anchor">#</a> message æ¶ˆæ¯</h3> <ol><li>å¯ä»¥æºå¸¦ properties å±æ€§</li> <li>==mandotary===true, å‘é€ç«¯ä¼šç›‘å¬åˆ°è·¯ç”±ä¸åˆ°çš„æ¶ˆæ¯, å³ returnCallback, =false æ—¶, è·¯ç”±ä¸åˆ°çš„æ¶ˆæ¯ä¼šè¢«è‡ªåŠ¨åˆ é™¤</li> <li>å‘é€ç«¯è¦å¤„ç†==confirmCallback== ==returnCallback==, é…ç½®é‡Œè¿™ä¸¤é¡¹å¿…é¡»è®¾ä¸º true</li> <li></li></ol> <h3 id="æ­»ä¿¡é˜Ÿåˆ—-ç‰¹æ®Šçš„-exchange"><a href="#æ­»ä¿¡é˜Ÿåˆ—-ç‰¹æ®Šçš„-exchange" class="header-anchor">#</a> æ­»ä¿¡é˜Ÿåˆ—(ç‰¹æ®Šçš„ exchange)</h3> <ol><li>æ¶ˆæ¯è¢« nack å¹¶ä¸” requeue=false</li> <li>ttl æ¶ˆæ¯è¿‡æœŸ</li> <li>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>ç§ä¿¡: å°±æ˜¯æ™®é€šçš„exchange--<span class="token operator">&gt;</span>queueç»‘å®š

ä¸šåŠ¡queue æ·»åŠ é¢å¤–çš„å‚æ•°: x-dead-letter-exchange<span class="token operator">=</span>æ­»ä¿¡äº¤æ¢æœº

è¿™æ ·ä¸šåŠ¡queueä¸Šæœªæ¶ˆè´¹çš„æ¶ˆæ¯å°±è·¯ç”±åˆ°äº†ç§ä¿¡äº¤æ¢æœºä¸Š
</code></pre></div><h3 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="header-anchor">#</a> æ¶ˆè´¹è€…</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;test.queue&quot;</span><span class="token punctuation">,</span> durable <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> autoDelete <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;test.exchange&quot;</span><span class="token punctuation">,</span> durable <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> autoDelete <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            key <span class="token operator">=</span> <span class="token string">&quot;test.#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@RabbitHandler</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ç›‘å¬å™¨"><a href="#ç›‘å¬å™¨" class="header-anchor">#</a> ç›‘å¬å™¨</h3> <ol><li>simpleMessageListenerContainer</li></ol> <p>ä¸ºé˜Ÿåˆ—æ·»åŠ ç›‘å¬äº‹ä»¶</p> <ol start="2"><li><p>messageListenerAdapter æ¶ˆæ¯é€‚é…å™¨</p> <p>å¤„ç†æ–¹æ³• å¯ä»¥ä¸ºæ¯ä¸ªé˜Ÿåˆ—æŒ‡å®šä¸åŒçš„å¤„ç†æ–¹æ³•</p></li> <li><p>messageConvert æ¶ˆæ¯è½¬åŒ–å™¨ java å¯¹è±¡ä¸ message å¯¹è±¡äº’è½¬</p></li></ol> <h3 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="header-anchor">#</a> é«˜å¯ç”¨</h3> <ol><li><p>é•œåƒé˜Ÿåˆ— : é…ç½® 1 ä¸ª Master, å¤šä¸ª Slaver</p> <div class="language-txt extra-class"><pre class="language-text"><code> 1. masterèŠ‚ç‚¹ /var/lib/rabbitmq/.erlang.cookie æ‹·è´åˆ°å„ä¸ªèŠ‚ç‚¹
 2. å¯åŠ¨æœåŠ¡ rabbitmq-server -detached
 3. å¤‡ç”¨èŠ‚ç‚¹åœæ­¢æœåŠ¡ rabbitmqctl stop_app
 4. å¤‡ç”¨èŠ‚ç‚¹åŠ å…¥åˆ°ä¸»èŠ‚ç‚¹é›†ç¾¤ä¸­ rabbitmqctl join_cluster rabbit@xxxx(hostså)
 5. å¤‡ç”¨èŠ‚ç‚¹å¯åŠ¨ rabbitmqctl start_app
 6. ä»»æ„èŠ‚ç‚¹è®¾ç½®é›†ç¾¤å rabbitmqctl set_cluster_name xxxx
 7. æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ rabbitmqctl cluster_status
 8. é…ç½®é•œåƒé˜Ÿåˆ—: rabbitmqctl set_policy ha-all &quot;^&quot; '{&quot;ha-mode&quot;:&quot;all}'
</code></pre></div></li> <li><p>haproxy: è´Ÿè½½å‡è¡¡</p></li></ol> <h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="header-anchor">#</a> æ’ä»¶</h3> <ol><li>å»¶æ—¶æ’ä»¶<code>rabbitmq_delayed_message_exchange</code><div class="language-bash extra-class"><pre class="language-bash"><code> <span class="token number">1</span>. /usr/lib/rabbitmq/lib/rabbitmq_serverxxx/plugins
 <span class="token number">2</span>. rabbitmq-plugins <span class="token builtin class-name">enable</span> xxxx
 <span class="token number">3</span>. å£°æ˜ä¸€ä¸ªx-delayed-typeç±»å‹çš„exchange
 <span class="token number">4</span>. å‘é€æ¶ˆæ¯æ—¶,æ¶ˆæ¯headerséœ€è¦æŒ‡å®šx-delay<span class="token operator">=</span>xxæ¯«ç§’
</code></pre></div></li></ol> <h2 id="spring-äº‹åŠ¡"><a href="#spring-äº‹åŠ¡" class="header-anchor">#</a> Spring äº‹åŠ¡</h2> <p>éš”ç¦»çº§åˆ«:</p> <div class="language- extra-class"><pre class="language-text"><code>ISOLATION_DEFAULT	ä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«
ISOLATION_READ_UNCOMMITTED	å…è®¸è¯»å–å°šæœªæäº¤çš„æ›´æ”¹ã€‚å¯èƒ½å¯¼è‡´è„è¯»ã€å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»
ISOLATION_READ_COMMITTED	å…è®¸ä»å·²ç»æäº¤çš„å¹¶å‘äº‹åŠ¡è¯»å–ã€‚å¯é˜²æ­¢è„è¯»ï¼Œä½†å¹»è¯»å’Œä¸å¯é‡å¤è¯»ä»å¯èƒ½ä¼šå‘ç”Ÿ
ISOLATION_REPEATABLE_READ	å¯¹ç›¸åŒå­—æ®µçš„å¤šæ¬¡è¯»å–çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®è¢«å½“å‰äº‹åŠ¡æœ¬èº«æ”¹å˜ã€‚å¯é˜²æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»å¯èƒ½å‘ç”Ÿ
ISOLATION_SERIALIZABLE	å®Œå…¨æœä»ACIDçš„éš”ç¦»çº§åˆ«ï¼Œç¡®ä¿ä¸å‘ç”Ÿè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚è¿™åœ¨æ‰€æœ‰éš”ç¦»çº§åˆ«ä¸­ä¹Ÿæ˜¯æœ€æ…¢çš„ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯é€šè¿‡å®Œå…¨é”å®šå½“å‰äº‹åŠ¡æ‰€æ¶‰åŠçš„æ•°æ®è¡¨æ¥å®Œæˆçš„, å¯ä»¥åŠ å…±äº«é”(ä¸æ’ä»–), ä¸€ä¸ªäº‹åŠ¡ä¸é‡Šæ”¾,å…¶å®ƒäº‹åŠ¡åªèƒ½è¯»æ•°æ®
</code></pre></div><p>ä¼ æ’­æœºåˆ¶:</p> <div class="language- extra-class"><pre class="language-text"><code>PROPAGATION_MANDATORY	è¡¨ç¤ºè¯¥æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡æ­£åœ¨å‘ç”Ÿï¼Œå°†æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
PROPAGATION_NESTED	è¡¨ç¤ºå¦‚æœå½“å‰æ­£æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿›è¡Œä¸­ï¼Œåˆ™è¯¥æ–¹æ³•åº”å½“è¿è¡Œåœ¨ä¸€ä¸ªåµŒå¥—å¼äº‹åŠ¡ä¸­ã€‚è¢«åµŒå¥—çš„äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºå°è£…äº‹åŠ¡è¿›è¡Œæäº¤æˆ–å›æ»šã€‚å¦‚æœå°è£…äº‹åŠ¡ä¸å­˜åœ¨ï¼Œè¡Œä¸ºå°±åƒPROPAGATION_REQUIRESä¸€æ ·ã€‚
PROPAGATION_NEVER	è¡¨ç¤ºå½“å‰çš„æ–¹æ³•ä¸åº”è¯¥åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡æ­£åœ¨è¿›è¡Œï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚
PROPAGATION_NOT_SUPPORTED	è¡¨ç¤ºè¯¥æ–¹æ³•ä¸åº”è¯¥åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœä¸€ä¸ªç°æœ‰äº‹åŠ¡æ­£åœ¨è¿›è¡Œä¸­ï¼Œå®ƒå°†åœ¨è¯¥æ–¹æ³•çš„è¿è¡ŒæœŸé—´è¢«æŒ‚èµ·ã€‚
PROPAGATION_SUPPORTS	è¡¨ç¤ºå½“å‰æ–¹æ³•ä¸éœ€è¦äº‹åŠ¡æ€§ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯å¦‚æœæœ‰ä¸€ä¸ªäº‹åŠ¡å·²ç»åœ¨è¿è¡Œçš„è¯ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªäº‹åŠ¡é‡Œè¿è¡Œã€‚
PROPAGATION_REQUIRES_NEW	è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»åœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡é‡Œè¿è¡Œã€‚ä¸€ä¸ªæ–°çš„äº‹åŠ¡å°†è¢«å¯åŠ¨ï¼Œè€Œä¸”å¦‚æœæœ‰ä¸€ä¸ªç°æœ‰äº‹åŠ¡åœ¨è¿è¡Œçš„è¯ï¼Œåˆ™å°†åœ¨è¿™ä¸ªæ–¹æ³•è¿è¡ŒæœŸé—´è¢«æŒ‚èµ·ã€‚
PROPAGATION_REQUIRES	è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœä¸€ä¸ªç°æœ‰äº‹åŠ¡æ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯¥æ–¹æ³•å°†åœ¨é‚£ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦åˆ™å°±è¦å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡ã€‚
</code></pre></div><h2 id="springmvc-å¼‚æ­¥å¤„ç†"><a href="#springmvc-å¼‚æ­¥å¤„ç†" class="header-anchor">#</a> SpringMvc å¼‚æ­¥å¤„ç†</h2> <p>Callable å¤šçº¿ç¨‹æ¨¡å¼: ä¸»çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´é˜»å¡</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/demo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>

        <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> callable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> callable<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>DeferredResult: æ¥å—è¯·æ±‚---&gt;å¤„ç†ä»»åŠ¡| |å¤„ç†å®Œæ¯•--&gt;å“åº”ç»“æœ</p> <h2 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h2> <div class="language-docker extra-class"><pre class="language-docker"><code><span class="token keyword">from</span>  å¿…é¡»æ˜¯ç¬¬ä¸€è¡Œ
<span class="token keyword">maintainer</span> ä½œè€…ä¿¡æ¯
<span class="token keyword">add</span> <span class="token keyword">copy</span> æ‹·è´æ–‡ä»¶<span class="token punctuation">,</span> addåŠŸèƒ½æ›´å¤š<span class="token punctuation">,</span> ä½ çŒœéƒ½æœ‰ä»€ä¹ˆåŠŸèƒ½<span class="token punctuation">?</span>
<span class="token keyword">run</span>  æ„å»ºæ—¶çš„å‘½ä»¤
<span class="token keyword">expose</span>  æš´éœ²ç«¯å£<span class="token punctuation">,</span>åªæ˜¯å»ºè®®<span class="token punctuation">,</span>    å®é™…ä½¿ç”¨æ—¶è¿˜éœ€è¦æ‰‹åŠ¨<span class="token punctuation">-</span>p  æŒ‡å®šç«¯å£æ˜ å°„
<span class="token keyword">workdir</span> æŒ‡å®šå·¥ä½œç›®å½• å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ä¼šåœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ
<span class="token keyword">cmd</span>  è¿è¡Œæ—¶å‘½ä»¤<span class="token punctuation">,</span>  ä¼šè¢«ä½¿ç”¨æ—¶å®¹å™¨çš„å‘½ä»¤è¦†ç›–
<span class="token keyword">entrypoint</span>  ä¸ä¼šè¢«å®¹å™¨è¿è¡Œæ—¶å‘½ä»¤è¦†ç›–
</code></pre></div><blockquote><p>ADD COPY ENV EXPOSE FROM LABEL STOPSIGNAL USER VOLUME WORKDIR</p></blockquote> <ol><li>æ„å»º docker é•œåƒ</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>docker build -t tagåç§° <span class="token builtin class-name">.</span>
<span class="token builtin class-name">.</span> æŒ‡å®šDockerfileæ‰€åœ¨è·¯å¾„
</code></pre></div><ol start="2"><li>ç™»å½•åˆ° hub</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>docker login
</code></pre></div><ol start="3"><li>æ¨é€</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>docker push <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> NAME<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span>
</code></pre></div><h2 id="gradle"><a href="#gradle" class="header-anchor">#</a> Gradle</h2> <p>gradle ä»»åŠ¡: å¾€ nexus å‘å¸ƒ jar</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">//Mavenä»“åº“çš„URL</span>
<span class="token keyword">def</span> MAVEN_REPO_RELEASE_URL<span class="token operator">=</span> <span class="token string">'http://xxxx/nexus/content/repositories/releases/'</span>
<span class="token keyword">def</span> MAVEN_REPO_SNAPSHOT_URL<span class="token operator">=</span> <span class="token string">'http://xxxxx/nexus/content/repositories/snapshots/'</span>
<span class="token comment">//ç™»å½•nexus çš„ç”¨æˆ·å</span>
<span class="token keyword">def</span> NEXUS_USERNAME<span class="token operator">=</span><span class="token string">'admin'</span>
<span class="token comment">//ç™»å½•nexus çš„å¯†ç </span>
<span class="token keyword">def</span> NEXUS_PASSWORD<span class="token operator">=</span><span class="token string">'admin'</span>
<span class="token keyword">def</span> ARTIFACT_ID <span class="token operator">=</span> <span class="token string">'demo'</span>
<span class="token comment">// type</span>
<span class="token keyword">def</span> TYPE <span class="token operator">=</span> <span class="token string">'jar'</span>
<span class="token comment">//description</span>
<span class="token keyword">def</span> DESCRIPTION <span class="token operator">=</span> <span class="token string">'è¿™é‡Œæ˜¯æè¿°'</span>

uploadArchives <span class="token punctuation">{</span>
    configuration <span class="token operator">=</span> configurations<span class="token punctuation">.</span>archives
    repositories <span class="token punctuation">{</span>
        mavenDeployer <span class="token punctuation">{</span>
            <span class="token function">snapshotRepository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> MAVEN_REPO_SNAPSHOT_URL<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">authentication</span><span class="token punctuation">(</span>userName<span class="token punctuation">:</span> NEXUS_USERNAME<span class="token punctuation">,</span> password<span class="token punctuation">:</span> NEXUS_PASSWORD<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token function">repository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> MAVEN_REPO_RELEASE_URL<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">authentication</span><span class="token punctuation">(</span>userName<span class="token punctuation">:</span> NEXUS_USERNAME<span class="token punctuation">,</span> password<span class="token punctuation">:</span> NEXUS_PASSWORD<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token function">repository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">'C:\\Users\\dd\\.m2\\repository'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//å®šä¹‰æœ¬åœ°mavenä»“åº“çš„åœ°å€</span>
            <span class="token function">repository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">'C:\\Users\\dd\\.gradle\\caches\\modules-2\\files-2.1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//å®šä¹‰æœ¬åœ°Gradleä»“åº“çš„åœ°å€</span>
            pom<span class="token punctuation">.</span>project <span class="token punctuation">{</span>
                version version
                artifactId ARTIFACT_ID
                groupId group
                packaging TYPE
                description DESCRIPTION
                licenses <span class="token punctuation">{</span>  
                    license <span class="token punctuation">{</span>  
                        name <span class="token string">'The Apache Software License, Version 2.0'</span>  
                        url <span class="token string">'http://www.apache.org/licenses/LICENSE-2.0.txt'</span>  
                        distribution <span class="token string">'xxxxxx'</span>  
                    <span class="token punctuation">}</span>  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">5 ä¸ªæœˆå‰</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Notes/notes/pass.html" class="prev">
        å¯†ç å­¦ ğŸ’¥
      </a></span> <span class="next"><a href="/Notes/notes/xianyu.html">
        ç ´çƒ‚~ ğŸ‘»
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Notes/assets/js/app.f969e584.js" defer></script><script src="/Notes/assets/js/2.224388cf.js" defer></script><script src="/Notes/assets/js/7.4c3aeaf8.js" defer></script>
  </body>
</html>
