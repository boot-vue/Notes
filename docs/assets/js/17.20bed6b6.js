(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{378:function(a,t,s){"use strict";s.r(t);var n=s(12),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"hdfs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hdfs"}},[a._v("#")]),a._v(" HDFS")]),a._v(" "),s("blockquote",[s("p",[a._v("分布式文件系统, 文件数据只追加,不修改")])]),a._v(" "),s("h2",{attrs:{id:"name-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#name-node"}},[a._v("#")]),a._v(" Name Node")]),a._v(" "),s("ol",[s("li",[a._v("默认数据块大小 128M df.blocksize")]),a._v(" "),s("li",[a._v("data 元数据, 内存存储, 磁盘 FsImage 备份")]),a._v(" "),s("li",[a._v("内存数据更新, Edits 磁盘文件不断追加操作")]),a._v(" "),s("li",[a._v("data 数据校验和")]),a._v(" "),s("li",[a._v("维护 data node 的心跳检查")])]),a._v(" "),s("h2",{attrs:{id:"data-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#data-node"}},[a._v("#")]),a._v(" Data Node")]),a._v(" "),s("ol",[s("li",[a._v("集群启动后, data node 间隔上报数据块信息")]),a._v(" "),s("li",[a._v("小文件归档, 还是独立的文件, 对于 name node 封装成一个整体")])]),a._v(" "),s("h2",{attrs:{id:"client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#client"}},[a._v("#")]),a._v(" Client")]),a._v(" "),s("blockquote",[s("p",[a._v("切分数据, 与 namenode&datanode 交互")])]),a._v(" "),s("h2",{attrs:{id:"secondary-namenode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#secondary-namenode"}},[a._v("#")]),a._v(" Secondary NameNode")]),a._v(" "),s("ol",[s("li",[a._v("监控 hdfs 运行状态, 辅助恢复 name node, 定期合并 FsImage 和 Edits & 更新内存中的 NameNode 数据")]),a._v(" "),s("li",[a._v("checkpoint 默认 1 小时, txns 次数检查(合并 fsimage&edits)")])]),a._v(" "),s("h2",{attrs:{id:"回收站"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回收站"}},[a._v("#")]),a._v(" 回收站")]),a._v(" "),s("blockquote",[s("p",[a._v("core-site.xml")])]),a._v(" "),s("ol",[s("li",[a._v("fs.trash.interval 0 禁用, 其他值: 存活时间(minutes)")]),a._v(" "),s("li",[a._v("fs.trash.checkpoint.interval 检查时间间隔")])]),a._v(" "),s("h2",{attrs:{id:"命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[a._v("#")]),a._v(" 命令")]),a._v(" "),s("blockquote",[s("p",[a._v("hadoop fs or hdfs dfs, dfs 是 fs 的实现类")])]),a._v(" "),s("blockquote",[s("p",[a._v("hadoop distcp hdfs://.... hdfs://... 集群间数据拷贝")])]),a._v(" "),s("blockquote",[s("p",[a._v("hadoop archive -archiveName xxx.har -p /data/.... /dest/... 归档文件")])]),a._v(" "),s("blockquote",[s("p",[a._v("hadoop fs -ls -R har:///dest/...")])]),a._v(" "),s("h2",{attrs:{id:"java"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java"}},[a._v("#")]),a._v(" Java")]),a._v(" "),s("blockquote",[s("p",[a._v("通过 FileSystem 操作 HDFS")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Configuration")]),a._v(" cfg "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("FileSystem")]),a._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("FileSystem")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("URI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hdfs://hadoop1:9000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" cfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"battery"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('//boolean mkdirs = fs.mkdirs(new Path("/data"));')]),a._v("\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("delete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);